![1645087680953-abb865c5-8d90-4d73-88e2-1a83c3a64a48.png](https://img2023.cnblogs.com/blog/2504969/202309/2504969-20230912094144002-843882265.png)

```plain
#知识点：
1、ASP环境搭建组合
2、ASP-数据库下载&植入
3、IIS-短文件&解析&写权限

WEB安全攻防：
1、Web源码
2、开发语言
3、中间件平台
4、数据库类型
5、第三方插件或软件
```

- #### ASP-数据库-MDB默认下载

```plain
Windows +iis + asp+ access(sqlserver)
Access 数据库一般后缀名（asp asa mdb(下载)）
mdb文件在他网站目录下（扫描得到，或者默认数据库配置）
默认：
C:\Inetpub\wwwroot\PowerEasy\Database
```

![1645087840741-a027ae40-0cc5-4f5f-9f05-4e187fb44ce6.png](https://img2023.cnblogs.com/blog/2504969/202309/2504969-20230912094208236-2020118381.png)

```plain
思路：如果我们知道这个数据库的地址，尝试可以下载获取数据库文件，获取当前管理员账号密码信息
访问：http://192.168.199.136:83/Database/powerseasy2006.mdb
就可以进行直接下载：
```

![1645087879763-b716e929-c356-48b2-b2f6-a5c992554759.png](https://img2023.cnblogs.com/blog/2504969/202309/2504969-20230912094241253-1499920899.png)

```plain
如果有解析配置文件，那么就进行解析，如果没有，则默认下载：
```

![1645087902026-e4f9285e-789c-466e-8a8f-6088dcf879f5.png](https://img2023.cnblogs.com/blog/2504969/202309/2504969-20230912094254893-2038749921.png)

- ASP-数据库-ASP后门植入连接

```plain
数据库目录文件：C:\Inetpub\wwwroot\aspcms\data，，数据库文件是以asp解析。
```

![1645087936205-8ac095c6-29b8-4c0e-9ebf-2f1711618891.png](https://img2023.cnblogs.com/blog/2504969/202309/2504969-20230912094313611-587410817.png)

```plain
直接访问：http://192.168.199.136:82/data/data.asp
```

![1645087963764-04ac24a1-9843-4bea-96f1-f104d8185531.png](https://img2023.cnblogs.com/blog/2504969/202309/2504969-20230912094326021-593901962.png)

```plain
如果留言等会有记录，那么写入后门代码，后门代码记录在数据库中，用菜刀连接执行。后门代码：┼攠數畣整爠煥敵瑳∨≡┩愾 ，连接密码为a
```

![1645087988980-ecc467cb-a9f6-4a95-b25d-775f7e550eff.png](https://img2023.cnblogs.com/blog/2504969/202309/2504969-20230912094346030-308023063.png)

- #### ASP-中间件-IIS短文件名探针-安全漏洞

```plain
用于不知道地址怎么探针，参考：https://www.freebuf.com/articles/web/172561.html
能够扫描到目录结构，探针数据库或者后台文件。
使用到iis_shortname_Scan.py：执行命令python2 iis_shortname_Scan.py http://192.168.199.136:82/
```

![1645088028357-1aca329f-2ed1-4e02-b769-e80f1865a068.png](https://img2023.cnblogs.com/blog/2504969/202309/2504969-20230912094403126-326980742.png)

```plain
执行后的结果：
```

![1645088051740-e658439a-145b-4722-8eab-1af6a9ab704c.png](https://img2023.cnblogs.com/blog/2504969/202309/2504969-20230912094414579-1212964741.png)

```plain
扫描借助的是字典，他借助的是漏洞。URL可以接目录的下一级。
```

- #### ASP-中间件-IIS文件上传解析-安全漏洞

```plain
账号密码：admin panfei806
登录后台后，访问http://192.168.199.136:81/upload.asp
上传1.asp后，能够访问。不能上传
上传1.jpg后，不能访问，能上传
上传111.asp;.jpg后，能够访问，能上传
假如有a.asp目录，里面有文件1.jpg 可以执行，能上传，但是目录不一定有。

模拟正常的数据包上传：返回地址/202211215412767127.jpg
```

![1645088132677-39ebb845-d788-4c7e-b27e-cf6685747adf.png](https://img2023.cnblogs.com/blog/2504969/202309/2504969-20230912094457393-353518821.png)

```plain
发现文件数据包：filepath参数
```

![1645088256638-eaa9015b-537a-43aa-a9a2-708ea8ebdf99.png](https://img2023.cnblogs.com/blog/2504969/202309/2504969-20230912094532973-549453418.png)

```plain
修改参数：
```

![1645088278846-2b43d599-f649-4290-9758-b41d2a3305b6.png](https://img2023.cnblogs.com/blog/2504969/202309/2504969-20230912094545332-1933169758.png)

```plain
就可以修改了，但是错误。
```

- #### ASP-中间件-IIS配置目录读写-安全配置

```plain
如果在配置过程中：点了写入
```

![1645088324425-5685458b-27c6-45da-a587-bfabd85c1de0.png](https://img2023.cnblogs.com/blog/2504969/202309/2504969-20230912094609395-1201528197.png)

```plain
开启webdav:，就会产生写入漏洞。需要满足两个条件
```

![1645088346699-75b803a3-4ce0-487a-abf0-c8ee1f7dac23.png](https://img2023.cnblogs.com/blog/2504969/202309/2504969-20230912094630388-1518423076.png)

```plain
如何判断这类型的漏洞，用到iisputscaner工具。
```

![1645088388922-3f880dd6-2eb4-4948-a76d-a58ec3a12a8d.png](https://img2023.cnblogs.com/blog/2504969/202309/2504969-20230912094653628-622475690.png)

```plain
利用，先put一个文件，一张图片里面带有后门的
```

![1645088416894-facac0fc-cc09-4294-9693-6f653aaa4284.png](https://img2023.cnblogs.com/blog/2504969/202309/2504969-20230912094708971-1816389546.png)

```plain
put完后然后进行移动：
```

![1645088448291-5609b616-f1d9-460b-91e9-dca7c49c3508.png](https://img2023.cnblogs.com/blog/2504969/202309/2504969-20230912094721916-574288561.png)